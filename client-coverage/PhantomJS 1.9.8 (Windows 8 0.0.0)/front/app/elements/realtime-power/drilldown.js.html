<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for ./front/app/elements/realtime-power/drilldown.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../../prettify.css">
    <link rel="stylesheet" href="../../../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">./front/app/elements/realtime-power/drilldown.js</span></h1>
    <h2>
        Statements: <span class="metric">2.78% <small>(1 / 36)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">0% <small>(0 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">0% <small>(0 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">2.78% <small>(1 / 36)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">./front/app/elements/realtime-power/</a> &#187; drilldown.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120</td><td class="line-coverage"><span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">angular.module('bl.analyze.solar.surface')
  .constant('energyDrillDownChartConfig', {
    credits: {enabled: false},
    chart: {
      height: 740,
      marginTop: 25,
      marginBottom: 80,
      marginRight: 120
    },
    title: {text: null},
    plotOptions: {series: {marker: {enabled: false}}},
    exporting: {enabled: false},
    colors: ['#ff7935', '#6b9e67'],
    tooltip: {
      valueSuffix: 'kW', backgroundColor: 'rgba(35,43,57,0.9)',
      style: {color: '#fff'},
      borderRadius: 3, borderWidth: 0,
      shadow: false, shared: false, useHTML: true
    },
    legend: {enabled:false},
    xAxis: [{
      type: 'datetime'
    }, {
      type: 'datetime', opposite: true, lineWidth: 0, minorGridLineWidth: 0,lineColor: 'transparent',
      labels: {enabled: false}, minorTickLength: 0,tickLength: 0
    }],
    yAxis: [{
      title: {text: null}, labels: {format: '{value}kW', style: {color: '#6b9e67'}},
      min: 0, lineWidth: 0, opposite: true
    }, {
      title: {text: null}, labels: {format: '{value}kWh', style: {color: '#ff7935'}},
      min: 0, gridLineWidth: 0, lineWidth: 0, opposite: true
    }]
  })
&nbsp;
  .controller('EnergyDrilldownController',
  ['$scope', '$timeout', '$modalInstance', '$filter', '$interpolate', 
    'energyService', 'lastTEDData', 'energyDrillDownChartConfig', 'solarTagService',
<span class="fstat-no" title="function not covered" >    function ($scope, $timeout, $modalInstance, $filter, $interpolate,</span>
              energyService, lastTEDData, energyDrillDownChartConfig, solarTagService) {
<span class="cstat-no" title="statement not covered" >      $scope.isDataLoaded = false;</span>
<span class="cstat-no" title="statement not covered" >      $scope.kpiData = {};</span>
<span class="cstat-no" title="statement not covered" >      $scope.chartConfig = angular.extend(energyDrillDownChartConfig, {</span>
        series: []
      });
&nbsp;
<span class="cstat-no" title="statement not covered" >      $scope.chartConfig.xAxis[0].labels = {</span>
        formatter : <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >          return $filter('amDateFormat')(this.value / 1000, 'ha');</span>
        }
      };
&nbsp;
<span class="cstat-no" title="statement not covered" >      $scope.chartConfig.tooltip.formatter = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        var tooltipObject = {</span>
          theDateTime: $filter('amDateFormat')(this.key / 1000, 'MMM D, h:mma'),
          infoLabel: this.series.name,
          infoValue: $filter('number')(this.y, 1),
          infoUnit: this.series.name === 'Energy Produced' ? 'kWh' : 'kW',
          infoColor: this.series.color
        };
&nbsp;
<span class="cstat-no" title="statement not covered" >        var tooltipString = [</span>
          '&lt;p&gt;{{ theDateTime }}&lt;/p&gt;',
          '&lt;p class="no-margin"&gt;{{ infoLabel }}: &amp;nbsp;&amp;nbsp; ',
          '&lt;span style="color: {{ infoColor }};"&gt;{{ infoValue }}{{ infoUnit }}&lt;/span&gt;&lt;/p&gt;'/*,
          '&lt;p&gt;Last update {{ lastUpdatedTime }}&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;'*/
        ].join('');
&nbsp;
<span class="cstat-no" title="statement not covered" >        return $interpolate(tooltipString)(tooltipObject);</span>
      };
&nbsp;
<span class="cstat-no" title="statement not covered" >      $scope.loadDrilldown = <span class="fstat-no" title="function not covered" >function (tedData) {</span></span>
<span class="cstat-no" title="statement not covered" >        $scope.kpiData = tedData.kpi;</span>
<span class="cstat-no" title="statement not covered" >        angular.extend($scope.chartConfig, {</span>
          series: [
            angular.extend(tedData.chart.energy, {color: '#ff7935',type: 'column',yAxis: 1}),
            angular.extend(tedData.chart.power, {color: '#6b9e67',type: 'spline',xAxis: 1})
          ]
        });
<span class="cstat-no" title="statement not covered" >        $timeout(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >          $scope.chartConfig.chart.height = $scope.getResponsiveChartHeight();</span>
<span class="cstat-no" title="statement not covered" >          $('#energy-drilldown-combochart').highcharts($scope.chartConfig);</span>
        }, 50);
&nbsp;
<span class="cstat-no" title="statement not covered" >        $scope.isDataLoaded = true;</span>
      };
&nbsp;
<span class="cstat-no" title="statement not covered" >      $scope.startWatchDrilldown = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        energyService.watchEnergyDrillDown(<span class="fstat-no" title="function not covered" >function (tedData) {</span></span>
<span class="cstat-no" title="statement not covered" >          $scope.loadDrilldown(tedData);</span>
        });
      };
&nbsp;
<span class="cstat-no" title="statement not covered" >      $scope.closeDrilldown = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        $modalInstance.dismiss('cancel');</span>
      };
&nbsp;
<span class="cstat-no" title="statement not covered" >      $scope.getResponsiveChartHeight = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        var windowHeight = $(window).height();</span>
<span class="cstat-no" title="statement not covered" >        var chartHeight = 740;</span>
<span class="cstat-no" title="statement not covered" >        if(windowHeight &gt; 898) {</span>
<span class="cstat-no" title="statement not covered" >          chartHeight += windowHeight - 904;</span>
        }
<span class="cstat-no" title="statement not covered" >        return chartHeight;</span>
      };
&nbsp;
<span class="cstat-no" title="statement not covered" >      $(window).resize(<span class="fstat-no" title="function not covered" >function(){</span></span>
<span class="cstat-no" title="statement not covered" >        var chartHeight = $scope.getResponsiveChartHeight();</span>
<span class="cstat-no" title="statement not covered" >        var chartWidth = $('#energy-drilldown-combochart').width();</span>
<span class="cstat-no" title="statement not covered" >        var chart = $('#energy-drilldown-combochart').highcharts();</span>
<span class="cstat-no" title="statement not covered" >        if((chart !== null) &amp;&amp; (typeof chart !== 'undefined')) {</span>
<span class="cstat-no" title="statement not covered" >          chart.setSize(chartWidth, chartHeight, true);</span>
        }
      });
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (lastTEDData) {</span>
<span class="cstat-no" title="statement not covered" >        $scope.loadDrilldown(lastTEDData);</span>
      }
    }
  ]);</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Oct 02 2015 18:20:33 GMT+0200 (Central Europe Daylight Time)</div>
</div>
<script src="../../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../../sorter.js"></script>
</body>
</html>
