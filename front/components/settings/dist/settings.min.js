"use strict";angular.module("blComponents.Settings",["ngImgCrop","ngClipboard","ngFileUpload","ui.router"]).controller("settingsWrapperController",["$scope",function(n){}]).directive("settingsWrapper",function(){return{restrict:"E",controller:"settingsWrapperController",scope:{selected:"=",currentUser:"=",onClose:"&"},template:['<div id="settings-wrapper">','<button type="button" class="close"><span aria-hidden="true">&times;</span></button>','<div class="global-settings-container" ui-view></div>',"</div>"].join(""),link:function(n,e){$(e).on("click","button.close",n.onClose),$(document).mouseup(function(n){var e=$(".form-field-input-wrapper:visible").parents("form-inline-editor");e.is(n.target)||0!==e.has(n.target).length||$(".form-field-input-wrapper:visible").hide().trigger("hidden.inline-editor")})}}}),angular.module("blComponents.Settings").controller("sourceManagementController",["$scope",function(n){n.init=function(){console.log("Source Managegment page is going here")},n.init()}]),angular.module("blComponents.Settings").filter("nameInitial",function(){return function(n){if(!n)return"";var e=n.split(" ").slice(0,-1).join(" ").toUpperCase(),r=n.split(" ").splice(-1).join(" ").toUpperCase();return e.substr(0,1)+r.substr(0,1)}}),angular.module("blComponents.Settings").factory("httpRequestInterceptor",["url",function(n){var e=function(e){return-1===e.search(/(.html|.js|.css|.png|.svg|.jpg|.gif|.swf)/i)?n.get()+e:e};return{appendApiEntryPoint:e,request:function(n){return n.url=e(n.url),-1===n.url.search(/(.html|.js|.css|.png|.svg|.jpg|.gif|.swf)/i)&&(n.withCredentials=!0),n}}}]).factory("httpResponseInterceptor",["$q",function(n){return{response:function(e){return"object"==typeof e.data&&1!==e.data.success?n.reject(e):n.when("object"==typeof e.data&&e.data.message?e.data.message:e)},responseError:function(e){return console.error("[Setting ERROR] - "+e.data.message),n.reject("object"==typeof e.data&&0===e.data.success?e.data.message:e)}}}]),angular.module("blComponents.Settings").controller("formInlineEditorController",["$scope",function(n){n.isSaving=!1,n.saveElement=function(){return n.isSaving=!0,n.onSave({})["finally"](function(){n.isSaving=!1})}}]).directive("formInlineEditor",function(){function n(n){n.find(".form-field-input-wrapper").hide(),n.find("span.echo").show()}function e(e,r){return e.innerForm.$invalid?(e.$apply(function(){e.submitted=!0}),!1):(n(r),e.saveElement().then(function(){},function(){e.fieldModel=angular.copy(i)}))}function r(n,e){var r=[];"email"===n?r.push('<span ng-if="innerForm.foo.$error.email">Invalid email address</span>'):"url"===n&&r.push('<span ng-if="innerForm.foo.$error.url">Not valid url</span>'),e&&e.split(" ").map(function(n){"required"===n?r.push('<span ng-if="innerForm.foo.$error.required">Required</span>'):"ng-phone-number"===n?r.push('<span ng-if="innerForm.foo.$error.phonenumber">Please input valid a phone number <br/>( ex: 1-800-275-2273)</span>'):"ng-full-name"===n&&r.push('<span ng-if="innerForm.foo.$error.fullname">First name and Last name are required</span>')});var i="";return r.length&&(i=['<p class="input-danger" ng-show="(innerForm.foo.$dirty || submitted) && innerForm.foo.$invalid">',r.join(""),"</p>"].join("")),i}var i;return{restrict:"E",scope:{fieldModel:"=",fieldForm:"=",onSave:"&fieldOnSave"},controller:"formInlineEditorController",transclude:!0,template:function(n,e){var i=e.type,t=["text","password","date","datetime","email","month","number","range","search","tel","time","url","week"],s=e.validation;(!i||t.indexOf(i)<0)&&(i="text");var a=r(i,s);return['<i class="icon icon-edit fade" ng-if="!isSaving"></i>','<i class="icon-blue-loading" ng-if="isSaving"></i>','<span class="echo" ng-transclude></span>','<ng-form name="innerForm">','<div class="input-group form-field-input-wrapper" style="display: none">','<input name="foo" type="'+i+'" class="form-control" ng-model="fieldModel"',s?" "+s:"",">",'<span class="input-group-btn">','<button class="btn btn-primary" type="button" ng-disabled="innerForm.$invalid && innerForm.$dirty">','{{ isSaving ? "Saving..." : "Save"}}',"</button>","</span>","</div>",a?a:"","</ng-form>"].join("")},link:function(n,r,t){var s=$(r);n.submitted=!1,s.on("mouseenter","span.echo",function(){s.find(".icon").addClass("in")}).on("mouseleave","span.echo",function(){s.find(".icon").removeClass("in")}).on("click","span.echo",function(){i=angular.copy(n.fieldModel)||"",s.find("span.echo").hide(),s.find(".form-field-input-wrapper").show().find("input.form-control").focus()}).on("hidden.inline-editor",".form-field-input-wrapper",function(){n.$apply(function(){n.fieldModel=angular.copy(i),n.innerForm.$setPristine()}),s.find("span.echo").show()}).on("click",".btn",function(){e(n,s)}).on("keypress","input.form-control",function(r){13===r.which&&e(n,s)})}}}),angular.module("blComponents.Settings").controller("profileDetailController",["$scope","$state","currentUser",function(n,e,r){n.currentUser=r}]),angular.module("blComponents.Settings").controller("profileManagementController",["$scope","$state","currentUser",function(n,e,r){n.currentUser=r,n.tabs=[{heading:"User Details",route:"settings.profile.detail",active:!0},{heading:"Social Networks",route:"settings.profile.social",active:!1}],n.init=function(){console.log("Profile is going here")},n.$on("$stateChangeSuccess",function(){n.tabs.forEach(function(n){n.active=e.is(n.route)})}),n.init()}]),angular.module("blComponents.Settings").constant("globalConfig",{"USER-ROLE":[{id:"BP",name:"BP "},{id:"Admin",name:"Admin "},{id:"TM",name:"Team Member "}],APIDOMAIN:window.apiDomain,PLATFORMDOMAIN:window.platformDomain,"REDIRECT-URL-AFTER-LOGOUT":window.platformDomain+"/login"}).constant("routerConfig",function(n,e){e.state("settings",{"abstract":!0,url:"/settings",template:"<div ui-view></div>"}).state("settings.profile",{url:"/profile",controller:"profileManagementController",templateUrl:"app/profile-management/profile.template.html",resolve:{currentUser:function(){return window.renderCurrentUser}}}).state("settings.profile.detail",{url:"/detail",controller:"profileDetailController",templateUrl:"app/profile-management/partials/detail.template.html"}).state("settings.profile.social",{url:"/social",template:"<h1>Settings -> Profile -> Social</h1>"}).state("settings.account",{url:"/account",template:"<h1>This is account page</h1>"}).state("settings.source",{url:"/source",controller:"sourceManagementController",templateUrl:"app/sources-management/list.template.html"})}).provider("url",["globalConfig",function(n){this.$get=function(){return{get:function(){return n.APIDOMAIN+"/v1"}}}}]).config(["$httpProvider","ngClipProvider","$stateProvider","$urlRouterProvider","routerConfig",function(n,e,r,i,t){n.interceptors.push("httpRequestInterceptor"),n.interceptors.push("httpResponseInterceptor"),e.setPath("//cdnjs.cloudflare.com/ajax/libs/zeroclipboard/2.1.6/ZeroClipboard.swf"),t(i,r)}]),angular.module("blComponents.Settings").run(["$templateCache",function(n){n.put("app/profile-management/profile.template.html",'<div class="panel panel-default">\r\n    <div class="panel-heading">\r\n        <i class="icon icon-ui-info"></i>\r\n        <h3 class="panel-title">Profile</h3>\r\n    </div>\r\n    <div class="panel-body">\r\n        <div class="jambo-brief setting-heading">\r\n            <div class="setting-heading-inner">\r\n                <div class="setting-header-visual col-xs-2">\r\n                    <div class="avatar-wrapper">\r\n                        <span class="avatar empty" ng-if="!currentUser.profilePictureUrl">\r\n                            {{currentUser.name | nameInitial}}\r\n                        </span>\r\n                        <span class="avatar" ng-if="currentUser.profilePictureUrl">\r\n                            <img ng-src="{{currentUser.profilePictureUrl}}" alt="" ng-hide="isAvatarLoading">\r\n                            <span class="avatar-over-text" ng-show="isAvatarLoading">Loading...</span>\r\n                        </span>\r\n                        <span class="avatar-over-text">Update</span>\r\n                    </div>\r\n                </div>\r\n                <div class="setting-header-textual col-xs-6">\r\n                    <h3 class="medium title">\r\n                        {{ currentUser.name }}\r\n                    </h3>\r\n                    <span class="label label-primary" ng-bind="currentUser.role"></span>\r\n                    <p class="medium">\r\n                        <a href="mailto:{{currentUser.email}}" ng-bind="currentUser.email"></a>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <tabset justified="true" class="settings-tab-header">\r\n            <tab ng-repeat="t in tabs" heading="{{ t.heading }}" ui-sref="{{ t.route }}" active="t.active">\r\n            </tab>\r\n        </tabset>\r\n        <div class="settings-tab-content" ui-view></div>\r\n    </div>\r\n</div>'),n.put("app/sources-management/list.template.html",'<div class="panel panel-default">\r\n    <div class="panel-heading">\r\n        <i class="icon icon-ui-info"></i>\r\n        <h3 class="panel-title">Source Management</h3>\r\n    </div>\r\n    <div class="panel-body">\r\n        <div class="source-wrapper">\r\n            <div class="source-heading">\r\n                <div class="source-search"><input type="text" class="" placeholder="Search"></div>\r\n                <button type="button" class="source-add-btn">\r\n                    Add\r\n                    <div class="add-caret"><span class="caret"></span></div>\r\n                </button>\r\n                <button type="button" class="source-group-btn">Group 14 Selected</button>\r\n            </div>\r\n            <div class="source-list">\r\n                <ul class="source-facility">\r\n                    <div class="facility-info">\r\n                        <div class="selector-wrapper"><input type="checkbox"></div>\r\n                        <div class="facility-name">Wyland Elementary<br>Kansas City, KS, USA</div>\r\n                        <div class="facility-potential-power">22,400kWh<br>Potential Power</div>\r\n                        <div class="facility-current-power">0.5kW<br>Current Power</div>\r\n                        <div class="facility-expansion-wrapper">\r\n                            <button type="button" class="dropup">Related Sources 2 <span class="caret"></span></button>\r\n                        </div>\r\n                    </div>\r\n                    <li class="source-scope">\r\n                        <div class="scope-info">\r\n                            <div class="selector-wrapper"><input type="checkbox"></div>\r\n                            <div class="scope-name">WebBox(Legacy)</div>\r\n                            <div class="scope-current-power">0.5kW<br>Current Power</div>\r\n                            <div class="scope-expansion-wrapper">\r\n                                <button type="button" class="dropup">Related Sources 2 <span class="caret"></span></button>\r\n                            </div>\r\n                        </div>\r\n                        <ul class="source-node">\r\n                            <li class="node-info">\r\n                                <div class="selector-wrapper"><input type="checkbox"></div>\r\n                                <div class="node-name">SB7000 Inverter EG3000 egauge 8795: Elevator</div>\r\n                                <div class="node-current-power">0.5kW<br>Current Power</div>\r\n                                <div class="node-operator-wrapper">\r\n                                    <div class="empty-wrapper">&nbsp;</div>\r\n                                    <div class="icon-wrapper">\r\n                                        <i class="icon-edit"></i>\r\n                                        <i class="icon-gear"></i>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="node-expansion-wrapper">\r\n                                    <button type="button" class="dropup">2 <span class="caret"></span></button>\r\n                                </div>\r\n                            </li>\r\n                            <li class="node-info">\r\n                                <div class="selector-wrapper"><input type="checkbox"></div>\r\n                                <div class="node-name">SB7000 Inverter EG3000 egauge 8795: Garage Lighting</div>\r\n                                <div class="node-current-power">0.5kW<br>Current Power</div>\r\n                                <div class="node-operator-wrapper">\r\n                                    <div class="empty-wrapper">&nbsp;</div>\r\n                                    <div class="icon-wrapper">\r\n                                        <i class="icon-edit"></i>\r\n                                        <i class="icon-gear"></i>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="node-expansion-wrapper">\r\n                                    <button type="button" class="dropup">2 <span class="caret"></span></button>\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </li>\r\n                    <li class="source-scope">\r\n                        <div class="scope-info">\r\n                            <div class="selector-wrapper"><input type="checkbox"></div>\r\n                            <div class="scope-name">WebBox(Legacy)</div>\r\n                            <div class="scope-current-power">0.5kW<br>Current Power</div>\r\n                            <div class="scope-expansion-wrapper">\r\n                                <button type="button" class="dropup">Related Sources 2 <span class="caret"></span></button>\r\n                            </div>\r\n                        </div>\r\n                        <ul class="source-node">\r\n                            <li class="node-info">\r\n                                <div class="selector-wrapper"><input type="checkbox"></div>\r\n                                <div class="node-name">SB7000 Inverter EG3000 egauge 8795: Elevator</div>\r\n                                <div class="node-current-power">0.5kW<br>Current Power</div>\r\n                                <div class="node-operator-wrapper">\r\n                                    <div class="empty-wrapper">&nbsp;</div>\r\n                                    <div class="icon-wrapper">\r\n                                        <i class="icon-edit"></i>\r\n                                        <i class="icon-gear"></i>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="node-expansion-wrapper">\r\n                                    <button type="button" class="dropup">2 <span class="caret"></span></button>\r\n                                </div>\r\n                            </li>\r\n                            <li class="node-info">\r\n                                <div class="selector-wrapper"><input type="checkbox"></div>\r\n                                <div class="node-name">SB7000 Inverter EG3000 egauge 8795: Garage Lighting</div>\r\n                                <div class="node-current-power">0.5kW<br>Current Power</div>\r\n                                <div class="node-operator-wrapper">\r\n                                    <div class="empty-wrapper">&nbsp;</div>\r\n                                    <div class="icon-wrapper">\r\n                                        <i class="icon-edit"></i>\r\n                                        <i class="icon-gear"></i>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="node-expansion-wrapper">\r\n                                    <button type="button" class="dropup">2 <span class="caret"></span></button>\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </li>\r\n                </ul>\r\n                <ul class="source-facility">\r\n                    <div class="facility-info">\r\n                        <div class="selector-wrapper"><input type="checkbox"></div>\r\n                        <div class="facility-name">Hoech Middle<br>Kansas City, KS, USA</div>\r\n                        <div class="facility-potential-power">22,400kWh<br>Potential Power</div>\r\n                        <div class="facility-current-power">0.5kW<br>Current Power</div>\r\n                        <div class="facility-expansion-wrapper">\r\n                            <button type="button">Related Sources 2 <span class="caret"></span></button>\r\n                        </div>\r\n                    </div>\r\n                </ul>\r\n                <ul class="source-facility">\r\n                    <div class="facility-info">\r\n                        <div class="selector-wrapper"><input type="checkbox"></div>\r\n                        <div class="facility-name">Kratz Elementary<br>Kansas City, KS, USA</div>\r\n                        <div class="facility-potential-power">22,400kWh<br>Potential Power</div>\r\n                        <div class="facility-current-power">0.5kW<br>Current Power</div>\r\n                        <div class="facility-expansion-wrapper">\r\n                            <button type="button">Related Sources 2 <span class="caret"></span></button>\r\n                        </div>\r\n                    </div>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'),n.put("app/profile-management/partials/detail.template.html",'<div class="form-wrapper">\r\n    <form class="form-setting-panel form-horizontal">\r\n        <fieldset class="form-group no-margin-left-right">\r\n            <label class="col-xs-2 control-label">Your Name</label>\r\n            <div class="col-xs-4 control-wrapper">\r\n                {{ currentUser.fullname || "Ivan Vesely" }}\r\n            </div>\r\n        </fieldset>\r\n\r\n        <fieldset class="form-group no-margin-left-right">\r\n            <label class="col-xs-2 control-label">Account</label>\r\n            <div class="col-xs-4 control-wrapper" ng-bind="currentAccount.name || \'No Account\'">\r\n            </div>\r\n        </fieldset>\r\n\r\n        <fieldset class="form-group no-margin-left-right">\r\n            <label class="col-xs-2 control-label">Role</label>\r\n            <div class="col-xs-4 control-wrapper">\r\n                {{ currentUser.role || "No Role" }}\r\n                <a class="link-more">\r\n                    <i class="icon icon-ui-info" ppanel-tooltip tooltip-text="infoTextOfRole"></i>\r\n                </a>\r\n            </div>\r\n        </fieldset>\r\n\r\n        <fieldset class="form-group no-margin-left-right">\r\n            <label for="inputUserPhone" class="col-xs-2 control-label">Phone</label>\r\n            <div class="col-xs-4 control-wrapper">\r\n                <form-inline-editor id="inputUserPhone" field-model="currentUser.phone" field-on-save="updateCurrentUser()" validation="ng-phone-number">\r\n                    {{ currentUser.phone || "No Phone Number" }}\r\n                </form-inline-editor>\r\n            </div>\r\n        </fieldset>\r\n\r\n        <fieldset class="form-group no-margin-left-right">\r\n            <label for="inputUserEmail" class="col-xs-2 control-label">Email</label>\r\n            <div class="col-xs-4 control-wrapper">\r\n                <ppanel-form-field-live id="inputUserEmail" field-model="currentUser.email" field-on-save="updateCurrentUser()" type="email" validation="required">\r\n                    {{ currentUser.email || \'No Email Address\' }}\r\n                </ppanel-form-field-live>\r\n            </div>\r\n        </fieldset>\r\n    </form>\r\n</div>\r\n<hr/>\r\n<div class="panel-actions">\r\n    <div class="row">\r\n        <div class="col-xs-4 col-xs-offset-2">\r\n            <div class="profile-page-actions">\r\n                <a class="btn-link" ng-click="showResetPasswdModal();">\r\n                    <i class="icon icon-password"></i> Reset Password\r\n                </a>\r\n                <a class="btn-link" ng-click="showDeleteAccountModal();">\r\n                    <i class="icon icon-trash"></i> Delete Account\r\n                </a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'),n.put("app/profile-management/partials/social.template.html","")}]);